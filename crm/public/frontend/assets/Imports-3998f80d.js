import{L as I}from"./LayoutHeader-cf0d6bfd.js";import{_ as P}from"./ViewBreadcrumbs-676366ac.js";import{l as u,X as C,c as d,b as t,w as B,d as o,u as a,t as c,F as w,r as O,B as f,g as G,f as s,ab as N,ac as p,ad as U,ae as h}from"./index-ecb7d9f9.js";import"./Icon-45f73f91.js";import"./index-51111d39.js";const D={class:"p-4 h-full overflow-auto"},J={class:"max-w-4xl space-y-4"},$={class:"grid grid-cols-1 sm:grid-cols-3 gap-2"},j={key:0,class:"rounded border p-3 bg-surface-white"},F={class:"text-sm mb-3"},z={class:"overflow-auto"},A={class:"min-w-full text-xs"},M={class:"grid grid-cols-1 sm:grid-cols-2 gap-2"},X={class:"grid grid-cols-1 sm:grid-cols-3 gap-2"},Z={class:"grid grid-cols-1 sm:grid-cols-3 gap-2"},q={key:0,class:"text-sm"},ae={__name:"Imports",setup(K){const g=u(""),m=u(""),V=u(""),r=u("CSV"),b=u(""),_=u(""),S=u(""),y=u(!1),x=u(!1),n=C({url:"crm.api.etl.preview",onError:i=>console.error(i)}),v=C({url:"crm.api.etl.import_rows",method:"POST",onError:i=>console.error(i)});function L(){n.submit({file_url:m.value||null,filedata:m.value?null:g.value,delimiter:V.value||null,max_rows:50})}function R(){const i={source_type:r.value,file_url:r.value==="CSV"&&m.value||null,sheet_id:r.value==="GOOGLE_SHEETS"&&b.value||null,sheet_range:r.value==="GOOGLE_SHEETS"&&_.value||null,dedupe:!0,link_organization:!0,mapping_profile:S.value||null,dry_run:!!y.value,scheduled:!!x.value};v.submit({payload:JSON.stringify(i)})}return(i,e)=>{var k;return s(),d("div",D,[t(I,null,{"left-header":B(()=>[t(P,{routeName:"Imports"})]),_:1}),o("div",J,[e[11]||(e[11]=o("div",{class:"text-lg font-medium"},"CSV Preview",-1)),t(a(N),{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=l=>g.value=l),rows:"8",placeholder:"Paste CSV here or provide a URL below"},null,8,["modelValue"]),o("div",$,[t(a(p),{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=l=>m.value=l),placeholder:"CSV URL (optional)"},null,8,["modelValue"]),t(a(p),{modelValue:V.value,"onUpdate:modelValue":e[2]||(e[2]=l=>V.value=l),placeholder:", (delimiter optional)"},null,8,["modelValue"]),t(a(U),{loading:a(n).loading,label:"Preview",onClick:L},null,8,["loading"])]),a(n).data?(s(),d("div",j,[e[9]||(e[9]=o("div",{class:"text-base font-medium mb-2"},"Headers",-1)),o("div",F,c((k=a(n).data.headers)==null?void 0:k.join(", ")),1),e[10]||(e[10]=o("div",{class:"text-base font-medium mb-2"},"Sample",-1)),o("div",z,[o("table",A,[o("thead",null,[o("tr",null,[(s(!0),d(w,null,O(a(n).data.headers,(l,E)=>(s(),d("th",{key:"h"+E,class:"px-2 py-1 text-left border-b"},c(l),1))),128))])]),o("tbody",null,[(s(!0),d(w,null,O(a(n).data.sample,(l,E)=>(s(),d("tr",{key:"r"+E},[(s(!0),d(w,null,O(l,(T,H)=>(s(),d("td",{key:"c"+H,class:"px-2 py-1 border-b"},c(T),1))),128))]))),128))])])])])):f("",!0),e[12]||(e[12]=o("div",{class:"text-lg font-medium mt-6"},"Create Import Job",-1)),o("div",M,[t(a(h),{options:[{label:"CSV",value:"CSV"},{label:"Google Sheets",value:"GOOGLE_SHEETS"}],modelValue:r.value,"onUpdate:modelValue":e[3]||(e[3]=l=>r.value=l)},null,8,["modelValue"]),r.value==="GOOGLE_SHEETS"?(s(),G(a(p),{key:0,modelValue:b.value,"onUpdate:modelValue":e[4]||(e[4]=l=>b.value=l),placeholder:"Google Sheet ID"},null,8,["modelValue"])):f("",!0),r.value==="GOOGLE_SHEETS"?(s(),G(a(p),{key:1,modelValue:_.value,"onUpdate:modelValue":e[5]||(e[5]=l=>_.value=l),placeholder:"Range (e.g. Sheet1!A:Z)"},null,8,["modelValue"])):f("",!0)]),o("div",X,[t(a(p),{modelValue:S.value,"onUpdate:modelValue":e[6]||(e[6]=l=>S.value=l),placeholder:"Mapping Profile (optional)"},null,8,["modelValue"]),t(a(h),{options:[{label:"Dry Run: Off",value:!1},{label:"Dry Run: On",value:!0}],modelValue:y.value,"onUpdate:modelValue":e[7]||(e[7]=l=>y.value=l)},null,8,["modelValue"]),t(a(h),{options:[{label:"Scheduled: Off",value:!1},{label:"Scheduled: On",value:!0}],modelValue:x.value,"onUpdate:modelValue":e[8]||(e[8]=l=>x.value=l)},null,8,["modelValue"])]),o("div",Z,[t(a(U),{variant:"solid",loading:a(v).loading,label:"Create Job",onClick:R},null,8,["loading"]),a(v).data?(s(),d("div",q,"Job: "+c(a(v).data.job_id),1)):f("",!0)])])])}}};export{ae as default};
//# sourceMappingURL=Imports-3998f80d.js.map
