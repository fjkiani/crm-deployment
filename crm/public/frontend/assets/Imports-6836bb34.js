import{L as U}from"./LayoutHeader-2584d87d.js";import{_ as T}from"./ViewBreadcrumbs-8312c203.js";import{l as i,X as w,c as s,b as u,w as H,d as a,u as l,t as v,F as x,r as y,B as c,g as h,f as t,ab as I,ac as g,ad as k,ae as R}from"./index-eede9189.js";import"./Icon-785b81c1.js";import"./index-acfc619b.js";const B={class:"p-4 h-full overflow-auto"},N={class:"max-w-4xl space-y-4"},P={class:"grid grid-cols-1 sm:grid-cols-3 gap-2"},J={key:0,class:"rounded border p-3 bg-surface-white"},$={class:"text-sm mb-3"},j={class:"overflow-auto"},D={class:"min-w-full text-xs"},F={class:"grid grid-cols-1 sm:grid-cols-2 gap-2"},z={class:"grid grid-cols-1 sm:grid-cols-3 gap-2"},A={key:0,class:"text-sm"},W={__name:"Imports",setup(X){const _=i(""),m=i(""),f=i(""),r=i("CSV"),V=i(""),b=i(""),d=w({url:"crm.api.etl.preview",onError:n=>console.error(n)}),p=w({url:"crm.api.etl.import_rows",method:"POST",onError:n=>console.error(n)});function C(){d.submit({file_url:m.value||null,filedata:m.value?null:_.value,delimiter:f.value||null,max_rows:50})}function G(){const n={source_type:r.value,file_url:r.value==="CSV"&&m.value||null,sheet_id:r.value==="GOOGLE_SHEETS"&&V.value||null,sheet_range:r.value==="GOOGLE_SHEETS"&&b.value||null,dedupe:!0,link_organization:!0};p.submit({payload:JSON.stringify(n)})}return(n,e)=>{var E;return t(),s("div",B,[u(U,null,{"left-header":H(()=>[u(T,{routeName:"Imports"})]),_:1}),a("div",N,[e[8]||(e[8]=a("div",{class:"text-lg font-medium"},"CSV Preview",-1)),u(l(I),{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=o=>_.value=o),rows:"8",placeholder:"Paste CSV here or provide a URL below"},null,8,["modelValue"]),a("div",P,[u(l(g),{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=o=>m.value=o),placeholder:"CSV URL (optional)"},null,8,["modelValue"]),u(l(g),{modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=o=>f.value=o),placeholder:", (delimiter optional)"},null,8,["modelValue"]),u(l(k),{loading:l(d).loading,label:"Preview",onClick:C},null,8,["loading"])]),l(d).data?(t(),s("div",J,[e[6]||(e[6]=a("div",{class:"text-base font-medium mb-2"},"Headers",-1)),a("div",$,v((E=l(d).data.headers)==null?void 0:E.join(", ")),1),e[7]||(e[7]=a("div",{class:"text-base font-medium mb-2"},"Sample",-1)),a("div",j,[a("table",D,[a("thead",null,[a("tr",null,[(t(!0),s(x,null,y(l(d).data.headers,(o,S)=>(t(),s("th",{key:"h"+S,class:"px-2 py-1 text-left border-b"},v(o),1))),128))])]),a("tbody",null,[(t(!0),s(x,null,y(l(d).data.sample,(o,S)=>(t(),s("tr",{key:"r"+S},[(t(!0),s(x,null,y(o,(O,L)=>(t(),s("td",{key:"c"+L,class:"px-2 py-1 border-b"},v(O),1))),128))]))),128))])])])])):c("",!0),e[9]||(e[9]=a("div",{class:"text-lg font-medium mt-6"},"Create Import Job",-1)),a("div",F,[u(l(R),{options:[{label:"CSV",value:"CSV"},{label:"Google Sheets",value:"GOOGLE_SHEETS"}],modelValue:r.value,"onUpdate:modelValue":e[3]||(e[3]=o=>r.value=o)},null,8,["modelValue"]),r.value==="GOOGLE_SHEETS"?(t(),h(l(g),{key:0,modelValue:V.value,"onUpdate:modelValue":e[4]||(e[4]=o=>V.value=o),placeholder:"Google Sheet ID"},null,8,["modelValue"])):c("",!0),r.value==="GOOGLE_SHEETS"?(t(),h(l(g),{key:1,modelValue:b.value,"onUpdate:modelValue":e[5]||(e[5]=o=>b.value=o),placeholder:"Range (e.g. Sheet1!A:Z)"},null,8,["modelValue"])):c("",!0)]),a("div",z,[u(l(k),{variant:"solid",loading:l(p).loading,label:"Create Job",onClick:G},null,8,["loading"]),l(p).data?(t(),s("div",A,"Job: "+v(l(p).data.job_id),1)):c("",!0)])])])}}};export{W as default};
//# sourceMappingURL=Imports-6836bb34.js.map
