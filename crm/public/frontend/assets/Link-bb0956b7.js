import{P as Z,l as L,y as _,bH as Q,aN as ee,z as R,G as te,f as p,g as T,w as M,b as P,A as $,d as k,n as U,c as y,t as S,u as i,ai as W,B,S as I,T as j,L as E,ao as ae,ap as se,r as G,F as H,aq as le,K,M as X,aA as re,ar as ne,an as J,X as oe,e as ue}from"./index-eede9189.js";function Y(...e){return new Date(...e)}function Le(e){return!e||e.toString()==="Invalid Date"?"":Z(e).set("hour",0).set("minute",0).set("second",0).set("millisecond",0).format("YYYY-MM-DD")}function q(e,r){let n=1;r<0&&(n=-1,r=Math.abs(r));const s=[];for(;r;)e=Y(e.getFullYear(),e.getMonth(),e.getDate()+n),s.push(e),r--;return n===-1?s.reverse():s}function ie(e,r){const s=[31,28,31,30,31,30,31,31,30,31,30,31][e];return e===1&&de(r)?29:s}function de(e){return e%400===0?!0:e%100===0?!1:e%4===0}function ze(){const e=L(0),r=L(0),n=_(()=>Y()),s=_(()=>{if(!(e.value&&r.value))return[];const o=r.value-1,v=e.value,m=Y(v,o,1),z=Y(v,o+1,0),t=m.getDay(),b=6-z.getDay(),g=q(m,-t),f=q(z,b),x=ie(o,v),a=q(m,x-1);let l=[...g,m,...a,...f];if(l.length<42){const u=l.at(-1);if(u){const c=q(u,42-l.length);l=l.concat(...c)}}return l}),d=_(()=>{const o=[],v=s.value.slice();for(;v.length;){const m=v.splice(0,7);o.push(m)}return o}),h=_(()=>{if(!(e.value&&r.value))return"";const o=Y(e.value,r.value-1,1);return`${o.toLocaleString("en-US",{month:"long"})}, ${o.getFullYear()}`});function w(){C(-1)}function D(){C(1)}function C(o){r.value=r.value+o,r.value<1&&(r.value=12,e.value=e.value-1),r.value>12&&(r.value=1,e.value=e.value+1)}return{currentYear:e,currentMonth:r,today:n,dates:s,datesAsWeeks:d,formattedMonth:h,prevMonth:w,nextMonth:D,changeMonth:C}}const ce={class:"w-full"},fe=["onClick"],pe={key:0,class:"flex text-base leading-5 items-center truncate"},me={class:"truncate"},ge={key:1,class:"absolute text-ink-gray-4 text-left truncate w-full pr-7"},he={class:"relative mt-1 rounded-lg bg-surface-modal text-base shadow-2xl"},ve={class:"relative px-1.5 pt-1.5"},ye={key:0,class:"truncate bg-surface-modal px-2.5 py-1.5 text-sm font-medium text-ink-gray-5"},be={class:"flex-1 truncate text-ink-gray-7"},xe={key:0,class:"my-1.5 rounded-md px-2.5 py-1.5 text-base text-ink-gray-5"},ke={key:0,class:"border-t border-outline-gray-modals p-1.5"},_e={__name:"Autocomplete",props:{modelValue:{type:String,default:""},options:{type:Array,default:()=>[]},size:{type:String,default:"md"},variant:{type:String,default:"subtle"},placeholder:{type:String,default:""},disabled:{type:Boolean,default:!1},filterable:{type:Boolean,default:!0},placement:{type:String,default:"bottom-start"}},emits:["update:modelValue","update:query","change"],setup(e,{expose:r,emit:n}){const s=e,d=n,h=L(""),w=L(!1),D=L(null),C=Q(),o=ee(),v=_(()=>"value"in C),m=_({get(){return v.value?C.value:s.modelValue},set(a){h.value="",a&&(w.value=!1),d(v.value?"change":"update:modelValue",a)}});function z(){w.value=!1}const t=_(()=>{var l;return!s.options||s.options.length==0?[]:((l=s.options[0])!=null&&l.group?s.options:[{group:"",items:s.options}]).map((u,c)=>({key:c,group:u.group,hideLabel:u.hideLabel||!1,items:s.filterable?b(u.items):u.items})).filter(u=>u.items.length>0)});function b(a){return h.value?a.filter(l=>[l.label,l.value].some(c=>(c||"").toString().toLowerCase().includes(h.value.toLowerCase()))):a}function g(a){if(typeof a=="string"){let u=t.value.flatMap(c=>c.items).find(c=>c.value===a);return(u==null?void 0:u.label)||a}return a==null?void 0:a.label}R(h,a=>{d("update:query",a)}),R(w,a=>{a&&te(()=>{D.value.el.focus()})});const f=_(()=>s.disabled?"text-ink-gray-5":"text-ink-gray-8"),x=_(()=>{let a={sm:"text-base rounded h-7",md:"text-base rounded h-8",lg:"text-lg rounded-md h-10",xl:"text-xl rounded-md h-10"}[s.size],l={sm:"py-1.5 px-2",md:"py-1.5 px-2.5",lg:"py-1.5 px-3",xl:"py-1.5 px-3"}[s.size],u=s.disabled?"disabled":s.variant,c={subtle:"border border-gray-100 bg-surface-gray-2 placeholder-ink-gray-4 hover:border-outline-gray-modals hover:bg-surface-gray-3 focus:bg-surface-white focus:border-outline-gray-4 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-outline-gray-3",outline:"border border-outline-gray-2 bg-surface-white placeholder-ink-gray-4 hover:border-outline-gray-3 hover:shadow-sm focus:bg-surface-white focus:border-outline-gray-4 focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-outline-gray-3",disabled:["border bg-surface-menu-bar placeholder-ink-gray-3",s.variant==="outline"?"border-outline-gray-2":"border-transparent"]}[u];return[a,l,c,f.value,"transition-colors w-full"]});return r({query:h}),(a,l)=>(p(),T(i(ne),{modelValue:m.value,"onUpdate:modelValue":l[3]||(l[3]=u=>m.value=u),nullable:""},{default:M(({open:u})=>[P(i(re),{class:"w-full",show:w.value,"onUpdate:show":l[2]||(l[2]=c=>w.value=c),placement:e.placement},{target:M(({open:c,togglePopover:A})=>[$(a.$slots,"target",I(j({open:c,togglePopover:A,isOpen:w.value,selectedValue:m.value,displayValue:g})),()=>[k("div",ce,[k("button",{class:U(["relative flex h-7 w-full items-center justify-between gap-2 rounded px-2 py-1 transition-colors",x.value]),onClick:()=>!e.disabled&&A()},[m.value?(p(),y("div",pe,[$(a.$slots,"prefix"),k("span",me,S(g(m.value)),1)])):(p(),y("div",ge,S(e.placeholder||""),1)),e.disabled?B("",!0):(p(),T(i(W),{key:2,name:"chevron-down",class:"absolute h-4 w-4 text-ink-gray-5 right-2","aria-hidden":"true"}))],10,fe)])])]),body:M(({isOpen:c})=>{var A;return[E(k("div",null,[k("div",he,[k("div",ve,[P(i(ae),{ref_key:"search",ref:D,class:"form-input w-full focus:bg-surface-gray-3 hover:bg-surface-gray-4 text-ink-gray-8",type:"text",onChange:l[0]||(l[0]=V=>{h.value=V.target.value}),value:h.value,autocomplete:"off",placeholder:"Search"},null,8,["value"]),k("button",{class:"absolute right-1.5 inline-flex h-7 w-7 items-center justify-center",onClick:l[1]||(l[1]=V=>m.value=null)},[P(i(W),{name:"x",class:"w-4 text-ink-gray-8"})])]),P(i(se),{class:"my-1 max-h-[12rem] overflow-y-auto p-1.5 pt-0",static:""},{default:M(()=>[(p(!0),y(H,null,G(t.value,V=>E((p(),y("div",{class:"mt-1.5",key:V.key},[V.group&&!V.hideLabel?(p(),y("div",ye,S(V.group),1)):B("",!0),(p(!0),y(H,null,G(V.items,O=>(p(),T(i(le),{as:"template",key:O.value,value:O},{default:M(({active:N,selected:F})=>[k("li",{class:U(["flex cursor-pointer items-center rounded px-2.5 py-1.5 text-base",{"bg-surface-gray-3":N}])},[$(a.$slots,"item-prefix",K({ref_for:!0},{active:N,selected:F,option:O})),$(a.$slots,"item-label",K({ref_for:!0},{active:N,selected:F,option:O}),()=>[k("div",be,S(O.label),1)])],2)]),_:2},1032,["value"]))),128))])),[[X,V.items.length>0]])),128)),t.value.length==0?(p(),y("li",xe," No results found ")):B("",!0)]),_:3}),i(o).footer?(p(),y("div",ke,[$(a.$slots,"footer",I(j({value:(A=D.value)==null?void 0:A.el._value,close:z})))])):B("",!0)])],512),[[X,c]])]}),_:3},8,["show","placement"])]),_:3},8,["modelValue"]))}},we={class:"space-y-1.5 p-[2px] -m-[2px]"},Ce={key:0,class:"flex flex-col gap-1"},Me={class:"flex-1 font-semibold truncate text-ink-gray-7"},Ve={class:"flex-1 text-sm truncate text-ink-gray-5"},$e={key:1,class:"flex-1 truncate text-ink-gray-7"},De={key:0},Se={__name:"Link",props:{doctype:{type:String,required:!0},filters:{type:[Array,Object,String],default:[]},modelValue:{type:String,default:""},hideMe:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:r}){const n=e,s=r,d=Q(),h=_(()=>"value"in d),w=_({get:()=>h.value?d.value:n.modelValue,set:t=>(t==null?void 0:t.value)&&s(h.value?"change":"update:modelValue",t==null?void 0:t.value)}),D=L(null),C=L("");J(()=>{var t;return(t=D.value)==null?void 0:t.query},t=>{t=t||"",C.value!==t&&(C.value=t,v(t))},{debounce:300,immediate:!0}),J(()=>n.doctype,()=>v(""),{debounce:300,immediate:!0});const o=oe({url:"frappe.desk.search.search_link",cache:[n.doctype,C.value,n.hideMe,n.filters],method:"POST",params:{txt:C.value,doctype:n.doctype,filters:n.filters},transform:t=>{let b=t.map(g=>({label:g.label||g.value,value:g.value,description:g.description}));return!n.hideMe&&n.doctype=="User"&&b.unshift({label:"@me",value:"@me"}),b}});function v(t){var b,g,f;n.doctype&&((b=o.data)!=null&&b.length&&t===((g=o.params)==null?void 0:g.txt)&&n.doctype===((f=o.params)==null?void 0:f.doctype)||(o.update({params:{txt:t,doctype:n.doctype,filters:n.filters}}),o.reload()))}function m(t){s(h.value?"change":"update:modelValue",""),t()}const z=_(()=>[{sm:"text-xs",md:"text-base"}[d.size||"sm"],"text-ink-gray-5"]);return(t,b)=>{const g=ue("Button");return p(),y("div",we,[i(d).label?(p(),y("label",{key:0,class:U(["block",z.value])},S(t.__(i(d).label)),3)):B("",!0),P(_e,{ref_key:"autocomplete",ref:D,options:i(o).data,modelValue:w.value,"onUpdate:modelValue":b[0]||(b[0]=f=>w.value=f),size:i(d).size||"sm",variant:i(d).variant,placeholder:i(d).placeholder,disabled:i(d).disabled,placement:i(d).placement,filterable:!1},{target:M(({open:f,togglePopover:x})=>[$(t.$slots,"target",I(j({open:f,togglePopover:x})))]),prefix:M(()=>[$(t.$slots,"prefix")]),"item-prefix":M(({active:f,selected:x,option:a})=>[$(t.$slots,"item-prefix",I(j({active:f,selected:x,option:a})))]),"item-label":M(({active:f,selected:x,option:a})=>[$(t.$slots,"item-label",I(j({active:f,selected:x,option:a})),()=>[a.description?(p(),y("div",Ce,[k("div",Me,S(a.label),1),k("div",Ve,S(a.description),1)])):(p(),y("div",$e,S(a.label),1))])]),footer:M(({value:f,close:x})=>[i(d).onCreate?(p(),y("div",De,[P(g,{variant:"ghost",class:"w-full !justify-start",label:t.__("Create New"),iconLeft:"plus",onClick:()=>i(d).onCreate(f,x)},null,8,["label","onClick"])])):B("",!0),k("div",null,[P(g,{variant:"ghost",class:"w-full !justify-start",label:t.__("Clear"),iconLeft:"x",onClick:()=>m(x)},null,8,["label","onClick"])])]),_:3},8,["options","modelValue","size","variant","placeholder","disabled","placement"])])}}},Be=Se;export{Be as _,_e as a,Y as b,Le as g,ze as u};
//# sourceMappingURL=Link-bb0956b7.js.map
