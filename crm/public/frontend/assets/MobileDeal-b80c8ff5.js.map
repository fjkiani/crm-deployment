{"version":3,"file":"MobileDeal-b80c8ff5.js","sources":["../../../../frontend/src/pages/MobileDeal.vue"],"sourcesContent":["<template>\n  <LayoutHeader>\n    <header\n      class=\"relative flex h-10.5 items-center justify-between gap-2 py-2.5 pl-2\"\n    >\n      <Breadcrumbs :items=\"breadcrumbs\">\n        <template #prefix=\"{ item }\">\n          <Icon v-if=\"item.icon\" :icon=\"item.icon\" class=\"mr-2 h-4\" />\n        </template>\n      </Breadcrumbs>\n      <div class=\"absolute right-0\">\n        <Dropdown\n          v-if=\"doc\"\n          :options=\"\n            statusOptions(\n              'deal',\n              document.statuses?.length\n                ? document.statuses\n                : document._statuses,\n              triggerStatusChange,\n            )\n          \"\n        >\n          <template #default=\"{ open }\">\n            <Button\n              v-if=\"doc.status\"\n              :label=\"doc.status\"\n              :iconRight=\"open ? 'chevron-up' : 'chevron-down'\"\n            >\n              <template #prefix>\n                <IndicatorIcon :class=\"getDealStatus(doc.status).color\" />\n              </template>\n            </Button>\n          </template>\n        </Dropdown>\n      </div>\n    </header>\n  </LayoutHeader>\n  <div\n    v-if=\"doc.name\"\n    class=\"flex h-12 items-center justify-between gap-2 border-b px-3 py-2.5\"\n  >\n    <AssignTo v-model=\"assignees.data\" doctype=\"CRM Deal\" :docname=\"dealId\" />\n    <div class=\"flex items-center gap-2\">\n      <CustomActions\n        v-if=\"document._actions?.length\"\n        :actions=\"document._actions\"\n      />\n      <CustomActions\n        v-if=\"document.actions?.length\"\n        :actions=\"document.actions\"\n      />\n    </div>\n  </div>\n  <div v-if=\"doc.name\" class=\"flex h-full overflow-hidden\">\n    <Tabs as=\"div\" v-model=\"tabIndex\" :tabs=\"tabs\" class=\"overflow-auto\">\n      <TabList class=\"!px-3\" />\n      <TabPanel v-slot=\"{ tab }\">\n        <div v-if=\"tab.name == 'Details'\">\n          <SLASection\n            v-if=\"doc.sla_status\"\n            v-model=\"doc\"\n            @updateField=\"updateField\"\n          />\n          <div\n            v-if=\"sections.data\"\n            class=\"flex flex-1 flex-col justify-between overflow-hidden\"\n          >\n            <SidePanelLayout\n              :sections=\"sections.data\"\n              doctype=\"CRM Deal\"\n              :docname=\"dealId\"\n              @reload=\"sections.reload\"\n              @beforeFieldChange=\"beforeStatusChange\"\n              @afterFieldChange=\"reloadAssignees\"\n            >\n              <template #actions=\"{ section }\">\n                <div v-if=\"section.name == 'contacts_section'\" class=\"pr-2\">\n                  <Link\n                    value=\"\"\n                    doctype=\"Contact\"\n                    @change=\"(e) => addContact(e)\"\n                    :onCreate=\"\n                      (value, close) => {\n                        _contact = {\n                          first_name: value,\n                          company_name: doc.organization,\n                        }\n                        showContactModal = true\n                        close()\n                      }\n                    \"\n                  >\n                    <template #target=\"{ togglePopover }\">\n                      <Button\n                        class=\"h-7 px-3\"\n                        variant=\"ghost\"\n                        icon=\"plus\"\n                        @click=\"togglePopover()\"\n                      />\n                    </template>\n                  </Link>\n                </div>\n              </template>\n              <template #default=\"{ section }\">\n                <div\n                  v-if=\"section.name == 'contacts_section'\"\n                  class=\"contacts-area\"\n                >\n                  <div\n                    v-if=\"\n                      dealContacts?.loading && dealContacts?.data?.length == 0\n                    \"\n                    class=\"flex min-h-20 flex-1 items-center justify-center gap-3 text-base text-ink-gray-4\"\n                  >\n                    <LoadingIndicator class=\"h-4 w-4\" />\n                    <span>{{ __('Loading...') }}</span>\n                  </div>\n                  <div\n                    v-else-if=\"section.contacts.length\"\n                    v-for=\"(contact, i) in section.contacts\"\n                    :key=\"contact.name\"\n                  >\n                    <div\n                      class=\"px-2 pb-2.5\"\n                      :class=\"[i == 0 ? 'pt-5' : 'pt-2.5']\"\n                    >\n                      <Section :opened=\"contact.opened\">\n                        <template #header=\"{ opened, toggle }\">\n                          <div\n                            class=\"flex cursor-pointer items-center justify-between gap-2 pr-1 text-base leading-5 text-ink-gray-7\"\n                          >\n                            <div\n                              class=\"flex h-7 items-center gap-2 truncate\"\n                              @click=\"toggle()\"\n                            >\n                              <Avatar\n                                :label=\"contact.full_name\"\n                                :image=\"contact.image\"\n                                size=\"md\"\n                              />\n                              <div class=\"truncate\">\n                                {{ contact.full_name }}\n                              </div>\n                              <Badge\n                                v-if=\"contact.is_primary\"\n                                class=\"ml-2\"\n                                variant=\"outline\"\n                                :label=\"__('Primary')\"\n                                theme=\"green\"\n                              />\n                            </div>\n                            <div class=\"flex items-center\">\n                              <Dropdown :options=\"contactOptions(contact.name)\">\n                                <Button\n                                  icon=\"more-horizontal\"\n                                  class=\"text-ink-gray-5\"\n                                  variant=\"ghost\"\n                                />\n                              </Dropdown>\n                              <Button\n                                variant=\"ghost\"\n                                @click=\"\n                                  router.push({\n                                    name: 'Contact',\n                                    params: { contactId: contact.name },\n                                  })\n                                \"\n                              >\n                                <ArrowUpRightIcon class=\"h-4 w-4\" />\n                              </Button>\n                              <Button variant=\"ghost\" @click=\"toggle()\">\n                                <FeatherIcon\n                                  name=\"chevron-right\"\n                                  class=\"h-4 w-4 text-ink-gray-9 transition-all duration-300 ease-in-out\"\n                                  :class=\"{ 'rotate-90': opened }\"\n                                />\n                              </Button>\n                            </div>\n                          </div>\n                        </template>\n                        <div\n                          class=\"flex flex-col gap-1.5 text-base text-ink-gray-8\"\n                        >\n                          <div class=\"flex items-center gap-3 pb-1.5 pl-1 pt-4\">\n                            <Email2Icon class=\"h-4 w-4\" />\n                            {{ contact.email }}\n                          </div>\n                          <div class=\"flex items-center gap-3 p-1 py-1.5\">\n                            <PhoneIcon class=\"h-4 w-4\" />\n                            {{ contact.mobile_no }}\n                          </div>\n                        </div>\n                      </Section>\n                    </div>\n                    <div\n                      v-if=\"i != section.contacts.length - 1\"\n                      class=\"mx-2 h-px border-t border-outline-gray-modals\"\n                    />\n                  </div>\n                  <div\n                    v-else\n                    class=\"flex h-20 items-center justify-center text-base text-ink-gray-5\"\n                  >\n                    {{ __('No contacts added') }}\n                  </div>\n                </div>\n              </template>\n            </SidePanelLayout>\n          </div>\n        </div>\n        <Activities\n          v-else\n          doctype=\"CRM Deal\"\n          :docname=\"dealId\"\n          :tabs=\"tabs\"\n          v-model:reload=\"reload\"\n          v-model:tabIndex=\"tabIndex\"\n          @beforeSave=\"beforeStatusChange\"\n          @afterSave=\"reloadAssignees\"\n        />\n      </TabPanel>\n    </Tabs>\n  </div>\n  <ErrorPage\n    v-else-if=\"errorTitle\"\n    :errorTitle=\"errorTitle\"\n    :errorMessage=\"errorMessage\"\n  />\n  <OrganizationModal\n    v-if=\"showOrganizationModal\"\n    v-model=\"showOrganizationModal\"\n    :data=\"_organization\"\n    :options=\"{\n      redirect: false,\n      afterInsert: (_doc) => updateField('organization', _doc.name),\n    }\"\n  />\n  <ContactModal\n    v-if=\"showContactModal\"\n    v-model=\"showContactModal\"\n    :contact=\"_contact\"\n    :options=\"{\n      redirect: false,\n      afterInsert: (_doc) => addContact(_doc.name),\n    }\"\n  />\n  <DeleteLinkedDocModal\n    v-if=\"showDeleteLinkedDocModal\"\n    v-model=\"showDeleteLinkedDocModal\"\n    :doctype=\"'CRM Deal'\"\n    :docname=\"dealId\"\n    name=\"Deals\"\n  />\n  <LostReasonModal\n    v-if=\"showLostReasonModal\"\n    v-model=\"showLostReasonModal\"\n    :deal=\"document\"\n  />\n</template>\n<script setup>\nimport DeleteLinkedDocModal from '@/components/DeleteLinkedDocModal.vue'\nimport ErrorPage from '@/components/ErrorPage.vue'\nimport Icon from '@/components/Icon.vue'\nimport DetailsIcon from '@/components/Icons/DetailsIcon.vue'\nimport LoadingIndicator from '@/components/Icons/LoadingIndicator.vue'\nimport ActivityIcon from '@/components/Icons/ActivityIcon.vue'\nimport EmailIcon from '@/components/Icons/EmailIcon.vue'\nimport Email2Icon from '@/components/Icons/Email2Icon.vue'\nimport CommentIcon from '@/components/Icons/CommentIcon.vue'\nimport PhoneIcon from '@/components/Icons/PhoneIcon.vue'\nimport TaskIcon from '@/components/Icons/TaskIcon.vue'\nimport NoteIcon from '@/components/Icons/NoteIcon.vue'\nimport AttachmentIcon from '@/components/Icons/AttachmentIcon.vue'\nimport WhatsAppIcon from '@/components/Icons/WhatsAppIcon.vue'\nimport IndicatorIcon from '@/components/Icons/IndicatorIcon.vue'\nimport ArrowUpRightIcon from '@/components/Icons/ArrowUpRightIcon.vue'\nimport SuccessIcon from '@/components/Icons/SuccessIcon.vue'\nimport LayoutHeader from '@/components/LayoutHeader.vue'\nimport Activities from '@/components/Activities/Activities.vue'\nimport OrganizationModal from '@/components/Modals/OrganizationModal.vue'\nimport LostReasonModal from '@/components/Modals/LostReasonModal.vue'\nimport AssignTo from '@/components/AssignTo.vue'\nimport ContactModal from '@/components/Modals/ContactModal.vue'\nimport Section from '@/components/Section.vue'\nimport Link from '@/components/Controls/Link.vue'\nimport SidePanelLayout from '@/components/SidePanelLayout.vue'\nimport SLASection from '@/components/SLASection.vue'\nimport CustomActions from '@/components/CustomActions.vue'\nimport { setupCustomizations } from '@/utils'\nimport { getView } from '@/utils/view'\nimport { getSettings } from '@/stores/settings'\nimport { globalStore } from '@/stores/global'\nimport { statusesStore } from '@/stores/statuses'\nimport { getMeta } from '@/stores/meta'\nimport { useDocument } from '@/data/document'\nimport {\n  whatsappEnabled,\n  callEnabled,\n  isMobileView,\n} from '@/composables/settings'\nimport { useActiveTabManager } from '@/composables/useActiveTabManager'\nimport {\n  createResource,\n  Dropdown,\n  Avatar,\n  Tabs,\n  TabList,\n  TabPanel,\n  Breadcrumbs,\n  call,\n  usePageMeta,\n  toast,\n} from 'frappe-ui'\nimport { ref, computed, h, watch } from 'vue'\nimport { useRoute, useRouter } from 'vue-router'\n\nconst { brand } = getSettings()\nconst { $dialog, $socket } = globalStore()\nconst { statusOptions, getDealStatus } = statusesStore()\nconst { doctypeMeta } = getMeta('CRM Deal')\nconst route = useRoute()\nconst router = useRouter()\n\nconst props = defineProps({\n  dealId: {\n    type: String,\n    required: true,\n  },\n})\n\nconst errorTitle = ref('')\nconst errorMessage = ref('')\nconst showDeleteLinkedDocModal = ref(false)\n\nconst { triggerOnChange, assignees, document, scripts, error } = useDocument(\n  'CRM Deal',\n  props.dealId,\n)\n\nconst doc = computed(() => document.doc || {})\n\nwatch(error, (err) => {\n  if (err) {\n    errorTitle.value = __(\n      err.exc_type == 'DoesNotExistError'\n        ? 'Document not found'\n        : 'Error occurred',\n    )\n    errorMessage.value = __(err.messages?.[0] || 'An error occurred')\n  } else {\n    errorTitle.value = ''\n    errorMessage.value = ''\n  }\n})\n\nwatch(\n  () => document.doc,\n  async (_doc) => {\n    if (scripts.data?.length) {\n      let s = await setupCustomizations(scripts.data, {\n        doc: _doc,\n        $dialog,\n        $socket,\n        router,\n        toast,\n        updateField,\n        createToast: toast.create,\n        deleteDoc: deleteDeal,\n        call,\n      })\n      document._actions = s.actions || []\n      document._statuses = s.statuses || []\n    }\n  },\n  { once: true },\n)\n\nconst reload = ref(false)\nconst showOrganizationModal = ref(false)\nconst _organization = ref({})\n\nconst breadcrumbs = computed(() => {\n  let items = [{ label: __('Deals'), route: { name: 'Deals' } }]\n\n  if (route.query.view || route.query.viewType) {\n    let view = getView(route.query.view, route.query.viewType, 'CRM Deal')\n    if (view) {\n      items.push({\n        label: __(view.label),\n        icon: view.icon,\n        route: {\n          name: 'Deals',\n          params: { viewType: route.query.viewType },\n          query: { view: route.query.view },\n        },\n      })\n    }\n  }\n\n  items.push({\n    label: title.value,\n    route: { name: 'Deal', params: { dealId: props.dealId } },\n  })\n  return items\n})\n\nconst title = computed(() => {\n  let t = doctypeMeta['CRM Deal']?.title_field || 'name'\n  return doc.value?.[t] || props.dealId\n})\n\nusePageMeta(() => {\n  return {\n    title: title.value,\n    icon: brand.favicon,\n  }\n})\n\nconst tabs = computed(() => {\n  let tabOptions = [\n    {\n      name: 'Details',\n      label: __('Details'),\n      icon: DetailsIcon,\n      condition: () => isMobileView.value,\n    },\n    {\n      name: 'Activity',\n      label: __('Activity'),\n      icon: ActivityIcon,\n    },\n    {\n      name: 'Emails',\n      label: __('Emails'),\n      icon: EmailIcon,\n    },\n    {\n      name: 'Comments',\n      label: __('Comments'),\n      icon: CommentIcon,\n    },\n    {\n      name: 'Data',\n      label: __('Data'),\n      icon: DetailsIcon,\n    },\n    {\n      name: 'Calls',\n      label: __('Calls'),\n      icon: PhoneIcon,\n      condition: () => callEnabled.value,\n    },\n    {\n      name: 'Tasks',\n      label: __('Tasks'),\n      icon: TaskIcon,\n    },\n    {\n      name: 'Notes',\n      label: __('Notes'),\n      icon: NoteIcon,\n    },\n    {\n      name: 'Attachments',\n      label: __('Attachments'),\n      icon: AttachmentIcon,\n    },\n    {\n      name: 'WhatsApp',\n      label: __('WhatsApp'),\n      icon: WhatsAppIcon,\n      condition: () => whatsappEnabled.value,\n    },\n  ]\n  return tabOptions.filter((tab) => (tab.condition ? tab.condition() : true))\n})\nconst { tabIndex } = useActiveTabManager(tabs, 'lastDealTab')\n\nconst sections = createResource({\n  url: 'crm.fcrm.doctype.crm_fields_layout.crm_fields_layout.get_sidepanel_sections',\n  cache: ['sidePanelSections', 'CRM Deal'],\n  params: { doctype: 'CRM Deal' },\n  auto: true,\n  transform: (data) => getParsedFields(data),\n})\n\nfunction getParsedFields(sections) {\n  sections.forEach((section) => {\n    if (section.name == 'contacts_section') return\n    section.columns[0].fields.forEach((field) => {\n      if (field.name == 'organization') {\n        field.create = (value, close) => {\n          _organization.value.organization_name = value\n          showOrganizationModal.value = true\n          close()\n        }\n        field.link = (org) =>\n          router.push({\n            name: 'Organization',\n            params: { organizationId: org },\n          })\n      }\n    })\n  })\n  return sections\n}\n\nconst showContactModal = ref(false)\nconst _contact = ref({})\n\nfunction contactOptions(contact) {\n  let options = [\n    {\n      label: __('Delete'),\n      icon: 'trash-2',\n      onClick: () => removeContact(contact),\n    },\n  ]\n\n  if (!contact.is_primary) {\n    options.push({\n      label: __('Set as Primary Contact'),\n      icon: h(SuccessIcon, { class: 'h-4 w-4' }),\n      onClick: () => setPrimaryContact(contact.name),\n    })\n  }\n\n  return options\n}\n\nasync function addContact(contact) {\n  if (dealContacts.data?.find((c) => c.name === contact)) {\n    toast.error(__('Contact already added'))\n    return\n  }\n\n  let d = await call('crm.fcrm.doctype.crm_deal.crm_deal.add_contact', {\n    deal: props.dealId,\n    contact,\n  })\n  if (d) {\n    dealContacts.reload()\n    toast.success(__('Contact added'))\n  }\n}\n\nasync function removeContact(contact) {\n  let d = await call('crm.fcrm.doctype.crm_deal.crm_deal.remove_contact', {\n    deal: props.dealId,\n    contact,\n  })\n  if (d) {\n    dealContacts.reload()\n    toast.success(__('Contact removed'))\n  }\n}\n\nasync function setPrimaryContact(contact) {\n  let d = await call('crm.fcrm.doctype.crm_deal.crm_deal.set_primary_contact', {\n    deal: props.dealId,\n    contact,\n  })\n  if (d) {\n    dealContacts.reload()\n    toast.success(__('Primary contact set'))\n  }\n}\n\nconst dealContacts = createResource({\n  url: 'crm.fcrm.doctype.crm_deal.api.get_deal_contacts',\n  params: { name: props.dealId },\n  cache: ['deal_contacts', props.dealId],\n  auto: true,\n  onSuccess: (data) => {\n    let contactSection = sections.data?.find(\n      (section) => section.name == 'contacts_section',\n    )\n    if (!contactSection) return\n    contactSection.contacts = data.map((contact) => {\n      return {\n        name: contact.name,\n        full_name: contact.full_name,\n        email: contact.email,\n        mobile_no: contact.mobile_no,\n        image: contact.image,\n        is_primary: contact.is_primary,\n        opened: false,\n      }\n    })\n  },\n})\n\nfunction updateField(name, value) {\n  value = Array.isArray(name) ? '' : value\n  let oldValues = Array.isArray(name) ? {} : doc.value[name]\n\n  if (Array.isArray(name)) {\n    name.forEach((field) => (doc.value[field] = value))\n  } else {\n    doc.value[name] = value\n  }\n\n  document.save.submit(null, {\n    onSuccess: () => (reload.value = true),\n    onError: (err) => {\n      if (Array.isArray(name)) {\n        name.forEach((field) => (doc.value[field] = oldValues[field]))\n      } else {\n        doc.value[name] = oldValues\n      }\n      toast.error(err.messages?.[0] || __('Error updating field'))\n    },\n  })\n}\n\nfunction deleteDeal() {\n  showDeleteLinkedDocModal.value = true\n}\n\nasync function triggerStatusChange(value) {\n  await triggerOnChange('status', value)\n  setLostReason()\n}\n\nconst showLostReasonModal = ref(false)\n\nfunction setLostReason() {\n  if (\n    getDealStatus(doc.status).type !== 'Lost' ||\n    (doc.lost_reason && doc.lost_reason !== 'Other') ||\n    (doc.lost_reason === 'Other' && doc.lost_notes)\n  ) {\n    document.save.submit()\n    return\n  }\n\n  showLostReasonModal.value = true\n}\n\nfunction beforeStatusChange(data) {\n  if (\n    data?.hasOwnProperty('status') &&\n    getDealStatus(data.status).type == 'Lost'\n  ) {\n    setLostReason()\n  } else {\n    document.save.submit(null, {\n      onSuccess: () => reloadAssignees(data),\n    })\n  }\n}\n\nfunction reloadAssignees(data) {\n  if (data?.hasOwnProperty('deal_owner')) {\n    assignees.reload()\n  }\n}\n</script>\n"],"names":["brand","getSettings","$dialog","$socket","globalStore","statusOptions","getDealStatus","statusesStore","doctypeMeta","getMeta","route","useRoute","router","useRouter","props","__props","errorTitle","ref","errorMessage","showDeleteLinkedDocModal","triggerOnChange","assignees","document","scripts","error","useDocument","doc","computed","watch","err","_a","_doc","setupCustomizations","toast","updateField","deleteDeal","call","reload","showOrganizationModal","_organization","breadcrumbs","items","view","getView","title","t","_b","usePageMeta","tabs","DetailsIcon","isMobileView","ActivityIcon","EmailIcon","CommentIcon","PhoneIcon","callEnabled","TaskIcon","NoteIcon","AttachmentIcon","WhatsAppIcon","whatsappEnabled","tab","tabIndex","useActiveTabManager","sections","createResource","data","getParsedFields","section","field","value","close","org","showContactModal","_contact","contactOptions","contact","options","removeContact","h","SuccessIcon","setPrimaryContact","addContact","dealContacts","c","contactSection","name","oldValues","triggerStatusChange","setLostReason","showLostReasonModal","beforeStatusChange","reloadAssignees"],"mappings":"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"}